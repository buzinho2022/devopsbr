name: step-build
on:
  workflow_dispatch:
    ## o mais proximo dos parametros do azuredevops 
    inputs:
      environment:
        type: choice
        description: environment
        options:
        - dev
        - hml
        - prd
# build app dotnet
jobs:
  deploy_dev:
    runs-on: Linux
    if: ${{ github.event.inputs.environment == 'dev' }} 
    steps:
    - uses: actions/checkout@v2
      name: checkout repository
    - run: |
        echo  deploy ambiente dev
                echo "POST API"
        echo "POST API"
        curl -k -X 'POST' \
                  'https://192.168.0.92:32770/api/Evento' \
                  -H 'accept: text/plain' \
                  -H 'Content-Type: application/json' \
                  -d '{
                        "buildId": 1010,
                        "nomeJob": "${{github.workflow}}",
                        "usuario": "${{ github.actor }}",
                        "ambiente": "dev",
                        "statusRun": "sucess",
                        "branch": "${{github.ref_name}}"
                      }'


  deploy_hml:
    runs-on: Linux
    if: ${{ github.event.inputs.environment == 'hml' }} 
    steps:
    - uses: actions/checkout@v2
      name: checkout repository
    - run: |
        echo  deploy ambiente hml
        curl -k -X 'POST' \
          'https://192.168.0.92:32770/api/Evento' \
          -H 'accept: text/plain' \
          -H 'Content-Type: application/json' \
          -d '{
                "buildId": 1010,
                "nomeJob": "${{github.workflow}}",
                "usuario": "${{ github.actor }}",
                "ambiente": "dev",
                "statusRun": "sucess",
                "branch": "${{github.ref_name}}"
              }'
        
  deploy_prd:
    runs-on: Linux
    if: ${{ github.event.inputs.environment == 'prd' }} 
    steps:
    - uses: actions/checkout@v2
      name: checkout repository
    - run: |
        echo  deploy ambiente prd
        curl -k -X 'POST' \
          'https://192.168.0.92:32770/api/Evento' \
          -H 'accept: text/plain' \
          -H 'Content-Type: application/json' \
          -d '{
                "buildId": 1010,
                "nomeJob": "${{github.workflow}}",
                "usuario": "${{ github.actor }}",
                "ambiente": "dev",
                "statusRun": "sucess",
                "branch": "${{github.ref_name}}"
              }' 
